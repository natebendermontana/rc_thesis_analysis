---
title: "Thesis Analysis: National Survey (Aug 3-9, 2020)"
author: "Nate Bender"
date: "5/4/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Packages / Libraries
```{r, eval=TRUE, include=FALSE}
setwd("/Users/natebender/Desktop/Repo/RCthesisanalysis/")
# install.packages("ltm")
# install.packages("fBasics")
# install.packages("ggcorrplot")
# install.packages("fastDummies")
library(psych)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(ggfortify)
library(GPArotation)
library(ltm)
library(ggpubr)
library(fBasics)
library(ggcorrplot)
library(car)
library(fastDummies)
```

```{r, include=FALSE}
# Load data, create second dataset of only accepted responses
d <- read.csv("/Users/natebender/Desktop/Graduate_School/Thesis/All-for-1.5/Analysis/dyn_national_20200828 - results-20200930-082116_NEW.csv")

d_accept <- d %>% 
  dplyr::filter(reject == 0)
```

```{r, eval=TRUE, include=FALSE}
# EDA ####
# Number of respondents / rejects
respondents <- d %>% 
  dplyr::filter(reject==0) %>% 
  count(respondent_id)

rejected <- d %>% 
  dplyr::filter(reject==1) %>% 
  count(respondent_id)
```

# Setup / EDA
After filtering the `r count(rejected)` rejected respondents, we're left with `r count(respondents)` valid respondents in the dataset. 

Gender breakdown of respondents is as follows: 
```{r, eval=T, echo=F}
# EDA --IN PROGRESS--
# There are 1055 respondents in d_accept, but I can only find a sum of 1049 respondents across all gender options and I can't find a way to display those skips/"n/a"s???
d_accept %>% 
  summarize(female = sum(gender==1, na.rm = TRUE),
            femalepercent = sum(gender==1, na.rm = TRUE)/sum(gender, na.rm =TRUE),
            male = sum(gender==2, na.rm = TRUE),
            malepercent = sum(gender==2, na.rm = TRUE)/sum(gender, na.rm =TRUE),
            other = sum(gender==3, na.rm = TRUE),
            otherpercent = sum(gender==3, na.rm = TRUE)/sum(gender, na.rm =TRUE),
            noanswer = sum(gender==4, na.rm = TRUE),
            noanswerpercent = sum(gender==4, na.rm = TRUE)/sum(gender, na.rm =TRUE),
            total = sum((gender==1)+(gender==2)+(gender==3)+(gender==4), na.rm = TRUE))
```

```{r, eval=F, include=F, echo=F}
# Early viz and desc stats tables...in progress
for.stats <- d_accept %>% 
  dplyr::select(
    matches("sr_3[a-o]"))

basicStats(for.stats)


ggplot(data = d_accept, aes(x=age)) + geom_bar()

ggplot(data = d_accept, aes(x=gender)) + geom_bar()

ggplot(data = for.stats, aes(x=sr_3a_importance_abortion)) + geom_bar()


cormatdesccontactnorms <- d_pca_descriptivecontactnorms %>%
  cor(., use = "pairwise.complete.obs")

ggcorrplot(cormatdesccontactnorms, # correlation matrix
           type = "lower", # print the lower part of the correlation matrix
           hc.order = TRUE, # hierarchical clustering of correlations
           lab = TRUE) # add correlation values as labels
```

```{r, eval=F, include=F, echo=F}
# EDA on dependent variables
mean(d_accept$sr_12a_actions_contacted_officials, na.rm=TRUE)
sd(d_accept$sr_12a_actions_contacted_officials, na.rm=TRUE)

# intention
mean(d_accept$sr_13a_takeactions_contact_officials, na.rm=TRUE)
sd(d_accept$sr_13a_takeactions_contact_officials, na.rm=TRUE)
```

# Principal Components Analysis
$$\\[.05in]$$
### Dynamic Norms
*"Do you think that over the PAST/NEXT 12 months the percentage of adults in the United States who contacted elected officials to urge them to take action to reduce global warming is..."*   

One factor solution:   
1. Two-item factor consisting of the two dynamic norms questions (changes in the number of ppl contacting reps in the past and future)

```{r eval=F, include=F}
# Visualize variables
# *** Need to address errors in this visualization code ***

ggscatter(d_accept, x = "sr_24_past_contact", y = "sr_25_future_contact", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson",
          xlab = "Test x", ylab = "Test Y")

shapiro.test(d_accept$sr_24_past_contact)
ggqqplot(d_accept$sr_24_past_contact, ylab = "past contact")

shapiro.test(d_accept$sr_25_future_contact)
ggqqplot(d_accept$sr_25_future_contact, ylab = "future contact")
```

```{r, eval=T, echo=F, warning=F}
res <- cor.test(d_accept$sr_24_past_contact,d_accept$sr_25_future_contact, method = "spearman")
print(res)

#mean(d_accept$sr_24_past_contact, na.rm=TRUE)
#sd(d_accept$sr_24_past_contact, na.rm=TRUE)

#mean(d_accept$sr_25_future_contact, na.rm=TRUE)
#sd(d_accept$sr_25_future_contact, na.rm=TRUE)
```
Correlation test of the two dynamic norms items shows strong positive correlation, with Spearman's rho of `r res$estimate` and p-value of `r res$p.value`.

$$\\[.05in]$$

### Descriptive Norms (contact)
*"To what extent do you think that the following people ARE CONTACTING (writing letters, emailing, or calling) their elected representatives in Congress to urge action on reducing climate change?"*

Three factor solution (70% cumulative variance (hereafter: cv))   
1. 1-item variable: Parents   
2. 2-item composite variable: Spouse, Children   
3. Multi-item composite variable: Non-immediate family

```{r, eval=T, echo=F}
d_pca_descriptivecontactnorms <- d_accept %>% 
  dplyr::select(
    matches("sr_19a"),
    matches("sr_19b"),
    matches("sr_19c"),
    matches("sr_19d"),
    matches("sr_19e"),
    matches("sr_19f"),
    matches("sr_19g"),
    matches("sr_19h"))
    
fa.parallel(d_pca_descriptivecontactnorms, fm='minres', fa='fa')
pca1 <- fa(d_pca_descriptivecontactnorms, nfactors = 4, rotate = "Varimax", fm="minres") 
print(pca1)
print(pca1$loadings,cutoff = 0.3)
```

#### Descriptive Norms (contact) - 1st factor (Parents) - desc stats
```{r, eval=T, echo=T}
mean(d_accept$sr_19a_contacting_officials__parents, na.rm=TRUE)
sd(d_accept$sr_19a_contacting_officials__parents, na.rm=TRUE)

summary(d_pca_descriptivecontactnorms)
sapply(d_pca_descriptivecontactnorms, sd, na.rm=TRUE)
```

#### Descriptive Norms (contact) - 2nd factor (Spouse & Children) - Correlation & desc stats
```{r, eval=T, echo=F}
res <- cor.test(d_accept$sr_19b_contacting_officials_spouse,d_accept$sr_19c_contacting_officials_children, method = "spearman", exact=FALSE)
print(res)

# mean(d_accept$sr_19b_contacting_officials_spouse, na.rm=TRUE)
# sd(d_accept$sr_19b_contacting_officials_spouse, na.rm=TRUE)

# mean(d_accept$sr_19c_contacting_officials_children, na.rm=TRUE)
# sd(d_accept$sr_19c_contacting_officials_children, na.rm=TRUE)
```
Correlation test of the two descriptive norms items for Spouse and Children, showing moderate positive correlation. Spearman's rho is `r res$estimate` with a p-value of `r res$p.value`.

#### Descriptive Norms (contact) - 3rd factor (Non-immediate family) - Cronbach Alpha
```{r, eval=T, echo=F}
d_pca_descriptivecontactnormsnonfamily <- d_accept %>% 
  dplyr::select(
    matches("sr_19d"),
    matches("sr_19e"),
    matches("sr_19f"),
    matches("sr_19g"),
    matches("sr_19h"))

psych::alpha(d_pca_descriptivecontactnormsnonfamily, use ="pairwise", na.rm = TRUE) 
```

$$\\[.05in]$$

### Descriptive Norms (role models)
*"How likely are you to consider each of these groups as behavioral role models?"*

Scree plot suggests four factors (78% cumulative var), but three factor solution makes the most sense.   
Three factor solution (71% cv):   
1. 1-item variable: Parents   
2. 2-item composite variable: Spouse, Children   
3. Multi-item composite variable: Non-immediate family

```{r eval=TRUE, echo=F}
d_pca_descriptiverolemodelnorms <- d_accept %>% 
  dplyr::select(
    matches("sr_20a"),
    matches("sr_20b"),
    matches("sr_20c"),
    matches("sr_20d"),
    matches("sr_20e"),
    matches("sr_20f"),
    matches("sr_20g"),
    matches("sr_20h"))
    
fa.parallel(d_pca_descriptiverolemodelnorms, fm='minres', fa='fa')
pca1 <- fa(d_pca_descriptiverolemodelnorms, nfactors = 4, rotate = "Varimax", fm="minres") 
print(pca1)
print(pca1$loadings,cutoff = 0.3) 
```

#### Descriptive Norms (role models) - 1st factor (Parents) - Descriptive stats
```{r, eval=T, echo=F}
mean(d_accept$sr_20a_rolemodels_parents, na.rm=TRUE)
sd(d_accept$sr_20a_rolemodels_parents, na.rm=TRUE)
```


#### Descriptive Norms (role models) - 2nd factor (Spouse & Children) - Correlation
```{r, eval=T, echo=F}
res <- cor.test(d_accept$sr_20b_rolemodels_spouse,d_accept$sr_20c_rolemodels_children, method = "spearman", exact=FALSE)
print(res)

mean(d_accept$sr_20b_rolemodels_spouse, na.rm=TRUE)
sd(d_accept$sr_20b_rolemodels_spouse, na.rm=TRUE)

mean(d_accept$sr_20c_rolemodels_children, na.rm=TRUE)
sd(d_accept$sr_20c_rolemodels_children, na.rm=TRUE)
```
Correlation test of the two descriptive norms items for Spouse and Children, showing moderate positive correlation. Spearman's rho is `r res$estimate` with a p-value of `r res$p.value`.

#### Descriptive Norms (role models) - 3rd factor (Non-immediate family) - Cronbach Alpha
```{r, eval=T, echo=F}
d_pca_descriptiverolemodelnormsnonfamily <- d_accept %>% 
  dplyr::select(
    matches("sr_20d"),
    matches("sr_20e"),
    matches("sr_20f"),
    matches("sr_20g"),
    matches("sr_20h"))

psych::alpha(d_pca_descriptiverolemodelnormsnonfamily, use ="pairwise", na.rm = TRUE) 

summary(d_pca_descriptivecontactnormsnonfamily)
sapply(d_pca_descriptivecontactnormsnonfamily, sd, na.rm=TRUE)
```

$$\\[.05in]$$

### Injunctive Norms (contact) 
*"To what extent do you think that the following people EXPECT YOU to contact (writing letters, emailing, or calling) your elected representatives to urge action on reducing climate change?"*

Scree plot suggests four factors (78% cv) but three (73% cv) makes the most sense.     
Three-factor solution:   
1. 1-item variable: Parents   
2. 2-item composite variable: Spouse, Children   
3. Multi-item composite variable: Non-immediate family

```{r, eval=T, echo=F}
d_pca_injunctivecontactnorms <- d_accept %>% 
  dplyr::select(
    matches("sr_22a"),
    matches("sr_22b"),
    matches("sr_22c"),
    matches("sr_22d"),
    matches("sr_22e"),
    matches("sr_22f"),
    matches("sr_22g"),
    matches("sr_22h"))

fa.parallel(d_pca_injunctivecontactnorms, fm='minres', fa='fa')
pca1 <- fa(d_pca_injunctivecontactnorms, nfactors = 4, rotate = "Varimax", fm="minres") 
print(pca1)
print(pca1$loadings,cutoff = 0.3)

summary(d_pca_injunctivecontactnorms)
sapply(d_pca_injunctivecontactnorms, sd, na.rm=TRUE)
```

#### Injunctive Norms (contact) - 2nd factor (Spouse & Children) - Correlation
```{r, eval=T, echo=F}
res <- cor.test(d_accept$sr_22b_expect_contact_spouse,d_accept$sr_22c_expect_contact_children, method = "spearman", exact=FALSE)
print(res)
```
Correlation test of the two descriptive norms items for Spouse and Children, showing moderate positive correlation. Spearman's rho is `r res$estimate` with a p-value of `r res$p.value`.

#### Injunctive Norms (contact) - 3rd factor (Non-family) - Cronbach Alpha
```{r, eval=T, echo=F}
d_pca_injunctivecontactnormsnonfamily <- d_accept %>% 
  dplyr::select(
    matches("sr_22d"),
    matches("sr_22e"),
    matches("sr_22f"),
    matches("sr_22g"),
    matches("sr_22h"))

psych::alpha(d_pca_injunctivecontactnormsnonfamily, use ="pairwise", na.rm = TRUE) 
```
$$\\[.05in]$$

### Injunctive Norms (compliance)
*"How motivated are you to comply with the expectations of each of these people?"*

Two factor solution (70% cv)    
1. Multi-item composite variable: Parents, Spouse, Children   
2. Multi-item composite variable: Otherfam, Friends, Cowork, Recpartners, Faith

```{r, eval=T, echo=F}
d_pca_injunctivecompliance <- d_accept %>% 
  dplyr::select(
    matches("sr_23a"),
    matches("sr_23b"),
    matches("sr_23c"),
    matches("sr_23d"),
    matches("sr_23e"),
    matches("sr_23f"),
    matches("sr_23g"),
    matches("sr_23h"))

fa.parallel(d_pca_injunctivecompliance, fm='minres', fa='fa')
pca1 <- fa(d_pca_injunctivecompliance, nfactors = 2, rotate = "Varimax", fm="minres") 
print(pca1)
print(pca1$loadings,cutoff = 0.3)

summary(d_pca_injunctivecompliance)
sapply(d_pca_injunctivecompliance, sd, na.rm=TRUE)
```

#### Injunctive Norms (compliance) - 1st factor (Immediate Family) - Cronbach Alpha
```{r, eval=T, echo=F}
d_pca_injunctivecompliancefamily <- d_accept %>% 
  dplyr::select(
    matches("sr_23a"),
    matches("sr_23b"),
    matches("sr_23c"))

psych::alpha(d_pca_injunctivecompliancefamily, use ="pairwise", na.rm = TRUE) 
```

#### Injunctive Norms (compliance) - 2nd factor (Non-family) - Cronbach Alpha
```{r, eval=T, echo=F}
d_pca_injunctivecompliancenonfamily <- d_accept %>% 
  dplyr::select(
    matches("sr_23d"),
    matches("sr_23e"),
    matches("sr_23f"),
    matches("sr_23g"),
    matches("sr_23h"))

psych::alpha(d_pca_injunctivecompliancenonfamily, use ="pairwise", na.rm = TRUE) 
```

$$\\[.05in]$$

### CIM - Benefits
*"How often do you hear ____ talk about the importance of reducing climate change?"*   
*[your friends, family, and coworkers]*   
*[public figures whom you respect]*   
*[about the importance of reducing climate change in the media? (TV, movies, radio, newspapers/news websites, magazines, etc.)]*

One-factor solution:   
1. Multi-item composite variable: F/Fam/Cowork, Public Figures, Media

```{r, eval=T, echo=F}
d_pca_CIMbenefits <- d_accept %>% 
  dplyr::select(
    matches("sr_16"),
    matches("sr_17"),
    matches("sr_18"))

fa.parallel(d_pca_CIMbenefits, fm='minres', fa='fa')
pca1 <- fa(d_pca_CIMbenefits, nfactors = 1, rotate = "Varimax", fm="minres") 
print(pca1)
print(pca1$loadings,cutoff = 0.3)
```

#### CIM - Benefits - Cronbach Alpha
```{r, eval=T, echo=F}
psych::alpha(d_pca_CIMbenefits, use ="pairwise", na.rm = TRUE) 
```

$$\\[.05in]$$

### CIM - Perceived Risk
*"How important is each of the following issues to you today?"*   
*"How important is the issue of climate change to you personally?"*   
*"How worried are you about climate change?"*   
*"How much do you think climate change will harm you personally?"*   
*"How much do you think climate change will harm future generations of people?"*

NOTE - removing #7 for now until I understand how to properly account for it. 

Three-factor solution   
1. Multi-item composite variable: CC importance as an issue, CC personal importance, CC worry, belief of personal harm from CC    
2. 1-item variable: anthropocentric CC belief
3. 1-item variable: belief of harm to future generations from CC

```{r, eval=T, echo=F}
d_pca_CIMperceivedrisk <- d_accept %>% 
  dplyr::select(
    matches("sr_3b_importance_climatechange"),
    matches("sr_8_importance_personally"),
    matches("sr_9_worried"),
    matches("sr_10_harm_you_personally"),
    matches("sr_11_harm_future_generations"))

fa.parallel(d_pca_CIMperceivedrisk, fm='minres', fa='fa')
pca1 <- fa(d_pca_CIMperceivedrisk, nfactors = 2, rotate = "Varimax", fm="minres") 
print(pca1)
print(pca1$loadings,cutoff = 0.3)
```

#### CIM - Perceived Risk - 1st factor (Personal) - Cronbach Alpha
```{r, eval=T, echo=F}
d_pca_CIMperceivedriskpersonal <- d_accept %>% 
  dplyr::select(
    matches("sr_3b_importance_climatechange"),
    matches("sr_8_importance_personally"),
    matches("sr_9_worried"),
    matches("sr_10_harm_you_personally"))

psych::alpha(d_pca_CIMperceivedriskpersonal, use ="pairwise", na.rm = TRUE) 
```

#### CIM - Perceived Risk - Descriptive stats on single-item variables
```{r, eval=T, echo=T}

mean(d_accept$sr_11_harm_future_generations, na.rm=TRUE)
sd(d_accept$sr_11_harm_future_generations, na.rm=TRUE)

mean(d_accept$sr_7_believe_about_climate_change, na.rm=TRUE)
sd(d_accept$sr_7_believe_about_climate_change, na.rm=TRUE)

```
$$\\[.05in]$$

### Efficacy
*"Below is a list of actions that individuals could take to reduce climate change. If YOU took these actions, how effective would each be for reducing climate change?"*   
*"Below are some public and private organizations who make decisions that have an impact on climate change. In general, how COMPETENT is each in addressing climate change?"*   
*"In general, how RESPONSIVE is each in addressing climate change?"*   
*"How much do you agree that each type of organization is generally IN A POSITION TO EFFECTIVELY reduce climate change?"* 

Three-factor solution:   
1. 1-item variable: 21a: Is contacting elected reps an effective action?   
2. Multi-item composite variable: All types (fed, state, business, ngo) are in a position to effect change   
3. Multi-item composite variable: The competency and responsiveness of fed, state, and business   
4. 2-item composite variable: The competency and responsiveness of ngo only

```{r, eval=T, echo=F}
d_pca_efficacysecond <- d_accept %>% 
  dplyr::select(
    matches("sr_27[a-d]"),
    matches("sr_28[a-d]"),
    matches("sr_29[a-d]"))

fa.parallel(d_pca_efficacysecond, fm='minres', fa='fa')
pca1 <- fa(d_pca_efficacysecond, nfactors = 3, rotate = "Varimax", fm="minres") 
print(pca1)
print(pca1$loadings,cutoff = 0.3)
```

#### Efficacy - 1st variable (contacting elected officials an effective action?)
```{r, eval=T, echo=F}
mean(d_accept$sr_21a_effective_actions_contacting_officials, na.rm=TRUE)
sd(d_accept$sr_21a_effective_actions_contacting_officials, na.rm=TRUE)
```

#### Efficacy - 2nd Factor (All types' ability to effect change) - Cronbach Alpha 
```{r, eval=T, echo=F}
d_pca_efficacyeffectchangesecond <- d_accept %>% 
  dplyr::select(
    matches("sr_29[a-d]"))

psych::alpha(d_pca_efficacyeffectchangesecond, use ="pairwise", na.rm = TRUE) 
```

#### Efficacy - 3rd Factor (Competency & Responsiveness of Fed, State, and Business) - Cronbach Alpha 
```{r, eval=T, echo=F}
d_pca_efficacycompetencyresponsivesecond <- d_accept %>% 
  dplyr::select(
    matches("sr_27[a-c]"),
    matches("sr_28[a-c]"))

psych::alpha(d_pca_efficacycompetencyresponsivesecond, use ="pairwise", na.rm = TRUE) 
```

#### Efficacy - 4th Factor (Competency & Responsiveness of NGO) - Correlation 
```{r, eval=T, echo=F}
res <- cor.test(d_accept$sr_27d_competent_ngo,d_accept$sr_28d_responsive_ngo, method = "spearman", exact=FALSE)
print(res)

mean(d_accept$sr_27d_competent_ngo, na.rm=TRUE)
sd(d_accept$sr_27d_competent_ngo, na.rm=TRUE)

mean(d_accept$sr_28d_responsive_ngo, na.rm=TRUE)
sd(d_accept$sr_28d_responsive_ngo, na.rm=TRUE)
```
Correlation test of the competency and responsiveness scores for NGOs shows moderate positive correlation. Spearman's rho is `r res$estimate` with a p-value of `r res$p.value`.  

$$\\[.05in]$$

### TPB Behavioral Attitude
*"For me, contacting (writing letters, emailing, phoning my elected representatives in Congress to urge action on climate change on a regular basis during the next year would be â€¦"*

Three-factor solution:   
1. Multi-item composite variable: cool/uncool, admirable/shameful, good/bad, exciting/boring   
2. Multi-item composite variable: useful/useless, pleasant/intimidating, sensible/foolish  
3. 1-item variable: easy/awkward   

```{r, eval=F, echo=F, include=F}
d_pca_behavioralattitude <- d_accept %>% 
    dplyr::select(-"sr_32_contact_useful_reversed") %>% 
    dplyr::select(-"sr_33_contact_pleasant_reversed") %>% 
    dplyr::select(-"sr_37_contact_foolish_reversed") %>% 
  dplyr::select(
    matches("sr_32"),
    matches("sr_33"),
    matches("sr_34"),
    matches("sr_35"),
    matches("sr_36"),
    matches("sr_37"),
    matches("sr_38"),
    matches("sr_39"))


fa.parallel(d_pca_behavioralattitude, fm='minres', fa='fa')
pca1 <- fa(d_pca_behavioralattitude, nfactors = 3, rotate = "Varimax", fm="minres") 
print(pca1)
print(pca1$loadings,cutoff = 0.3)
```

```{r, eval=T, echo=F}
d_accept <- d_accept %>% 
  mutate(sr_32_contact_useful_reversed = car::recode(sr_32_contact_useful, "1=6 ; 2=5 ; 3=4 ; 4=3 ; 5=2 ; 6=1")) 

d_accept <- d_accept %>% 
  mutate(sr_33_contact_pleasant_reversed = car::recode(sr_33_contact_pleasant, "1=6 ; 2=5 ; 3=4 ; 4=3 ; 5=2 ; 6=1"))

d_accept <- d_accept %>%
  mutate(sr_37_contact_foolish_reversed = car::recode(sr_37_contact_foolish, "1=6 ; 2=5 ; 3=4 ; 4=3 ; 5=2 ; 6=1"))

ba2 <- d_accept %>% 
  dplyr::select(
    matches("sr_32_contact_useful_reversed"),
    matches("sr_33_contact_pleasant_reversed"),
    matches("sr_34"),
    matches("sr_35"),
    matches("sr_36"),
    matches("sr_37_contact_foolish_reversed"),
    matches("sr_38"),
    matches("sr_39"))


fa.parallel(ba2, fm='minres', fa='fa')
pca1 <- fa(ba2, nfactors = 3, rotate = "Varimax", fm="minres") 
print(pca1)
print(pca1$loadings,cutoff = 0.3)
```

#### TPB Behavioral Attitude - 1st factor - Correlation
```{r, eval=T, echo=F}
res <- cor.test(d_accept$sr_38_contact_admirable,d_accept$sr_39_contact_good, method = "spearman")
print(res)
```
The two measures of perceived behavioral control show a moderate positive relationship, just barely under the .65 rule of thumb. Spearman's rho is `r res$estimate` with a p-value of `r res$p.value`.   


#### TPB Behavioral Attitude - 2nd factor - Cronbach Alpha
```{r, eval=T, echo=F}
d_pca_behavioralattitude2 <- d_accept %>% 
  dplyr::select(
    matches("sr_32_contact_useful_reversed"),
    matches("sr_33_contact_pleasant_reversed"),
    matches("sr_37_contact_foolish_reversed"))

psych::alpha(d_pca_behavioralattitude2, use ="pairwise", na.rm = TRUE) 
```

#### TPB Behavioral Attitude - 3rd factor - Cronbach Alpha
```{r, eval=T, echo=F}
d_pca_behavioralattitude3 <- d_accept %>% 
  dplyr::select(
    matches("sr_34"),
    matches("sr_35"),
    matches("sr_36"))

psych::alpha(d_pca_behavioralattitude3, use ="pairwise", na.rm = TRUE) 
```

$$\\[.05in]$$
#### Perceived Behavioral Control - correlation
```{r, eval=T, echo=F, warning=F}
mean(d_accept$sr_35_contact_easy, na.rm=TRUE)
sd(d_accept$sr_35_contact_easy, na.rm=TRUE)
```

### Perceived Behavioral Control
```{r, eval=T, echo=F, warning=F}
res <- cor.test(d_accept$sr_30_easy_to_call,d_accept$sr_31_able_to_call, method = "spearman")
print(res)

#mean(d_accept$sr_30_easy_to_call, na.rm=TRUE)
#sd(d_accept$sr_30_easy_to_call, na.rm=TRUE)

#mean(d_accept$sr_31_able_to_call, na.rm=TRUE)
#sd(d_accept$sr_31_able_to_call, na.rm=TRUE)
```
The two measures of perceived behavioral control show a moderate positive relationship, just barely under the .65 rule of thumb. Spearman's rho is `r res$estimate` with a p-value of `r res$p.value`. This is not a strong enough correlation to justify a composite variable of the two items, so they will stay separate.

$$\\[.05in]$$

### Worldviews
We decided these will be kept as-is.

```{r, eval=T, echo=F}
d_worldviews <- d_accept %>% 
  dplyr::select(
    matches("sr_41a"),
    matches("sr_41b"),
    matches("sr_41c"),
    matches("sr_41d"),
    matches("sr_41e"),
    matches("sr_41f"))

summary(d_worldviews)
sapply(d_worldviews, sd, na.rm=TRUE)
```
$$\\[.05in]$$


# Creating PCA variables for regression
#### leaving this out of the markup file unless you'd like to review the variable creation code
```{r, eval=T, include=F}
# Dynamic, descriptive, and injunctive norms
d_accept <- d_accept %>% 
  mutate(
    descdynamicnorms_comp = rowMeans(subset(d_accept, select = c(sr_24_past_contact, sr_25_future_contact)), na.rm = T),
    desccontactnorms_fam_comp = rowMeans(subset(d_accept, select = c(sr_19b_contacting_officials_spouse, sr_19c_contacting_officials_children)), na.rm = T),
    desccontactnorms_nf_comp = rowMeans(subset(d_accept, select = c(sr_19d_contacting_officials_otherfamily, sr_19e_contacting_officials_friends, sr_19f_contacting_officials_coworkers, sr_19g_contacting_officials_recpartners, sr_19h_contacting_officials_faithcommun)), na.rm=T),
    descrolemodelnorms_fam_comp = rowMeans(subset(d_accept, select = c(sr_20b_rolemodels_spouse, sr_20c_rolemodels_children)), na.rm = T),
    descrolemodelnorms_nf_comp = rowMeans(subset(d_accept, select = c(sr_20d_rolemodels_otherfamily, sr_20e_rolemodels_friends, sr_20f_rolemodels_coworkers, sr_20g_rolemodels_recpartners, sr_20h_rolemodels_faithcommun)), na.rm=T),
    injunctcontactnorms_fam_comp = rowMeans(subset(d_accept, select = c(sr_22b_expect_contact_spouse, sr_22c_expect_contact_children)), na.rm = T),
    injunctcontactnorms_nf_comp = rowMeans(subset(d_accept, select = c(sr_22d_expect_contact_otherfamily, sr_22e_expect_contact_friends, sr_22f_expect_contact_coworkers, sr_22g_expect_contact_recpartners, sr_22h_expect_contact_faithcommun)), na.rm=T),
    injunctmotivation_fam_comp = rowMeans(subset(d_accept, select = c(sr_23a_motivated_to_comply_parents, sr_23b_motivated_to_comply_spouse,sr_23c_motivated_to_comply_children)), na.rm = T),
    injunctmotivation_nf_comp = rowMeans(subset(d_accept, select = c(sr_23d_motivated_to_comply_otherfamily, sr_23e_motivated_to_comply_friends, sr_23f_motivated_to_comply_coworkers, sr_23g_motivated_to_comply_recpartners, sr_23h_motivated_to_comply_faithcommun)), na.rm = T),
      )

# CIM - Benefits
d_accept <- d_accept %>% 
  mutate(
    cimbenefits_comp = rowMeans(subset(d_accept, select = c(sr_16_hear_friends_talk, sr_17_hear_media, sr_18_hear_public_officials)), na.rm = T))

# CIM - Perceived Risk
d_accept <- d_accept %>% 
  mutate(
    cimperceivedrisk_comp = rowMeans(subset(d_accept, select = c(sr_3a_importance_abortion, sr_8_importance_personally, sr_9_worried, sr_10_harm_you_personally)), na.rm = T))

# Efficacy
d_accept <- d_accept %>% 
  mutate(
    efficacy_effectiveness_comp = rowMeans(subset(d_accept, select = c(sr_29a_effective_fed, sr_29b_effective_state, sr_29c_effective_business, sr_29d_effective_ngo)), na.rm = T),
    efficacy_fedstatebusiness_competresp_comp = rowMeans(subset(d_accept, select = c(sr_27a_competent_fed, sr_27b_competent_state, sr_27c_competent_business, sr_28a_responsive_fed, sr_28b_responsive_state, sr_28c_responsive_business)), na.rm = T),
    efficacy_ngo_competresp_comp = rowMeans(subset(d_accept, select = c(sr_27d_competent_ngo, sr_28d_responsive_ngo)), na.rm = T)
    )

# TPB - Behavioral Attitude
d_accept <- d_accept %>% 
  mutate(
    behatt_admirablegood_comp = rowMeans(subset(d_accept, select = c(sr_38_contact_admirable, sr_39_contact_good)), na.rm = T),
    behatt_usefulpleasantsensible_comp = rowMeans(subset(d_accept, select = c(sr_32_contact_useful_reversed, sr_33_contact_pleasant_reversed, sr_37_contact_foolish_reversed)), na.rm = T),
    behatt_coolexcitingeasy_comp = rowMeans(subset(d_accept, select = c(sr_34_contact_cool, sr_35_contact_easy, sr_36_contact_exciting)), na.rm = T)
    )

# test to make sure variable-creation code is working
d_accept %>% 
  dplyr::select(sr_32_contact_useful_reversed, sr_33_contact_pleasant_reversed, sr_37_contact_foolish_reversed, behatt_usefulpleasantsensible_comp)
```

```{r, eval=F, echo=F}
mean(d_accept$descdynamicnorms_comp, na.rm=T)
sd(d_accept$descdynamicnorms_comp, na.rm=T)

mean(d_accept$desccontactnorms_fam_comp, na.rm=T)
sd(d_accept$desccontactnorms_fam_comp, na.rm=T)

mean(d_accept$desccontactnorms_nf_comp, na.rm=T)
sd(d_accept$desccontactnorms_nf_comp, na.rm=T)

mean(d_accept$descrolemodelnorms_fam_comp, na.rm=T)
sd(d_accept$descrolemodelnorms_fam_comp, na.rm=T)

mean(d_accept$descrolemodelnorms_nf_comp, na.rm=T)
sd(d_accept$descrolemodelnorms_nf_comp, na.rm=T)

mean(d_accept$injunctcontactnorms_fam_comp, na.rm=T)
sd(d_accept$injunctcontactnorms_fam_comp, na.rm=T)

mean(d_accept$injunctcontactnorms_nf_comp, na.rm=T)
sd(d_accept$injunctcontactnorms_nf_comp, na.rm=T)

mean(d_accept$injunctmotivation_fam_comp, na.rm=T)
sd(d_accept$injunctmotivation_fam_comp, na.rm=T)

mean(d_accept$injunctmotivation_nf_comp, na.rm=T)
sd(d_accept$injunctmotivation_nf_comp, na.rm=T)

mean(d_accept$cimbenefits_comp, na.rm=T)
sd(d_accept$cimbenefits_comp, na.rm=T)

mean(d_accept$cimperceivedrisk_comp, na.rm=T)
sd(d_accept$cimperceivedrisk_comp, na.rm=T)

mean(d_accept$efficacy_effectiveness_comp, na.rm=T)
sd(d_accept$efficacy_effectiveness_comp, na.rm=T)

mean(d_accept$efficacy_fedstatebusiness_competresp_comp, na.rm=T)
sd(d_accept$efficacy_fedstatebusiness_competresp_comp, na.rm=T)

mean(d_accept$efficacy_ngo_competresp_comp, na.rm=T)
sd(d_accept$efficacy_ngo_competresp_comp, na.rm=T)

mean(d_accept$behatt_admirablegood_comp, na.rm=T)
sd(d_accept$behatt_admirablegood_comp, na.rm=T)

mean(d_accept$behatt_usefulpleasantsensible_comp, na.rm=T)
sd(d_accept$behatt_usefulpleasantsensible_comp, na.rm=T)

mean(d_accept$behatt_coolexcitingeasy_comp, na.rm=T)
sd(d_accept$behatt_coolexcitingeasy_comp, na.rm=T)
```
$$\\[.05in]$$

# Creating dummy categorical variables
#### leaving this out of the markup file unless you'd like to review the variable creation code
```{r, eval=T, include=F}
# Gender (3 categories: Female, male, other, prefer not to say. Ref: Female)
d_accept <- dummy_cols(d_accept, select_columns = 'gender')

d_accept <- d_accept %>% 
  rename(gender_female = gender_1,
         gender_male = gender_2,
         gender_other = gender_3,
         gender_prefernottosay = gender_4)

d_accept %>% 
  dplyr::select(
    starts_with("gender")
  )

# Marital Status (3 categories: single, married/partner, divorced/separated, widowed. Ref: Single)
d_accept <- dummy_cols(d_accept, select_columns = "sr_56_marital_status")

d_accept <- d_accept %>% 
  rename(sr_56_marital_status_single = sr_56_marital_status_1,
         sr_56_marital_status_marriedpartner = sr_56_marital_status_2,
         sr_56_marital_status_divorcedseparated = sr_56_marital_status_3,
         sr_56_marital_status_widowed = sr_56_marital_status_4)

d_accept %>% 
  dplyr::select(
    starts_with("sr_56_marital_status")
  )

# Education level (5 categories: some high school, high school grad or equiv, some college, Assoc deg, Bachelor deg, Grad/prof deg. Ref: Some high school)
d_accept <- dummy_cols(d_accept, select_columns = "sr_61_education")

d_accept <- d_accept %>% 
  rename(sr_61_education_somehighschool = sr_61_education_1,
         sr_61_education_highschooldegree = sr_61_education_2,
         sr_61_education_somecollege = sr_61_education_3,
         sr_61_education_associatedegree = sr_61_education_4,
         sr_61_education_bachelordegree = sr_61_education_5,
         sr_61_education_gradorprofdegree = sr_61_education_6)

d_accept %>% 
  dplyr::select(
    starts_with("sr_61_education")
  )

# Type of work (5 categories: fulltime work, parttime work, homemaker, retired/semiretired, student, unemployed. Ref: Fulltime work)
d_accept <- dummy_cols(d_accept, select_columns = "sr_71_employment_status")

d_accept <- d_accept %>% 
  rename(sr_71_employment_status_workfulltime = sr_71_employment_status_1,
         sr_71_employment_status_workparttime = sr_71_employment_status_2,
         sr_71_employment_status_homemaker = sr_71_employment_status_3,
         sr_71_employment_status_retired = sr_71_employment_status_4,
         sr_71_employment_status_student = sr_71_employment_status_5,
         sr_71_employment_status_unemployed = sr_71_employment_status_6)

d_accept %>% 
  dplyr::select(
    starts_with("sr_71_employment_status")
  )

# Income level (8 categories: under25k, 25-50, 50-75, 75-100, 100-150. 150-200, 200-250, 250+, prefer not to say. Ref: under25k)
d_accept <- dummy_cols(d_accept, select_columns = "sr_72_income")

d_accept <- d_accept %>% 
  rename(sr_72_income_under25k = sr_72_income_1,
         sr_72_income_25to49k = sr_72_income_2,
         sr_72_income_50to74k = sr_72_income_3,
         sr_72_income_75to99k = sr_72_income_4,
         sr_72_income_100to149k = sr_72_income_5,
         sr_72_income_150to199k = sr_72_income_6,
         sr_72_income_200to249k = sr_72_income_7,
         sr_72_income_over250k = sr_72_income_8,
         sr_72_income_prefernottoanswer = sr_72_income_9)

d_accept %>% 
  dplyr::select(
    starts_with("sr_72_income")
  )

# Race (1 category: white, any other. Ref: white) # race_white_dumvar
d_accept <- d_accept %>%
  mutate(race_white_dumvar = ifelse(d_accept$sr_74_1_race_white==1 & is.na(d_accept$sr_74_2_race_black) & is.na(d_accept$sr_74_3_race_hispanic) & is.na(d_accept$sr_74_4_race_native_american) & is.na(d_accept$sr_74_5_race_east_asian) & is.na(d_accept$sr_74_6_race_middle_eastern) & is.na(d_accept$sr_74_7_race_south_asian),1,0))
  
d_accept %>%
  dplyr::select(sr_74_1_race_white, sr_74_2_race_black, sr_74_3_race_hispanic, sr_74_4_race_native_american, sr_74_5_race_east_asian, sr_74_6_race_middle_eastern, sr_74_7_race_south_asian, race_white_dumvar) %>% 
  arrange(desc(race_white_dumvar)) %>% 
  head(700)
  
# Political affiliation (5 categories: Dem, Rep, Independent, Green party, Libertarian, No party. Ref: Dem)
d_accept <- dummy_cols(d_accept, select_columns = "sr_78_political_affiliation")

d_accept <- d_accept %>% 
  rename(sr_78_political_affiliation_Dem = sr_78_political_affiliation_1,
         sr_78_political_affiliation_Rep = sr_78_political_affiliation_2,
         sr_78_political_affiliation_Ind = sr_78_political_affiliation_3,
         sr_78_political_affiliation_Green = sr_78_political_affiliation_4,
         sr_78_political_affiliation_Libertarian = sr_78_political_affiliation_5,
         sr_78_political_affiliation_NoParty = sr_78_political_affiliation_6)

d_accept %>% 
  dplyr::select(
    starts_with("sr_78_political_affiliation")
  )

# Ideology (4 categories: very lib, somewhat lib, moderate, somewhat conservative, very conservative. Ref: Very liberal)
d_accept <- dummy_cols(d_accept, select_columns = "sr_79_political_leaning")

d_accept <- d_accept %>% 
  rename(sr_79_political_leaning_VeryLib = sr_79_political_leaning_1,
         sr_79_political_leaning_SomeLib = sr_79_political_leaning_2,
         sr_79_political_leaning_Moderate = sr_79_political_leaning_3,
         sr_79_political_leaning_SomeConservative = sr_79_political_leaning_4,
         sr_79_political_leaning_VeryConservative = sr_79_political_leaning_5)

d_accept %>% 
  dplyr::select(
    starts_with("sr_79_political_leaning")
  )

```
```{r eval=F, include=F}
# Age   

# Number of records w/ dependents, adult children, and no children
d_accept %>% 
  count(sr_57i_dependents >= 1)
d_accept %>% 
  count(sr_57j_adultchildren >= 1)
d_accept %>% 
  count(sr_57k_nochildren == 0)

# number of white respondents
sum(d_accept$sr_74_1_race_white==1, na.rm = T)
# number of other ethnicities
sum(d_accept$sr_74_2_race_black==2 | d_accept$sr_74_3_race_hispanic==3 | d_accept$sr_74_4_race_native_american==4 | d_accept$sr_74_5_race_east_asian==5 | d_accept$sr_74_6_race_middle_eastern==6 | d_accept$sr_74_7_race_south_asian==7, na.rm = T)
```

$$\\[.05in]$$
# Ordinal logistic regression
$$\\[.05in]$$

```{r, eval=T, include=T}
library(MASS)

# Convert RV (12a) past contact to a factor and assign labels
d_accept$sr_12a_actions_contacted_officials_factor <- factor(d_accept$sr_12a_actions_contacted_officials)
levels(d_accept$sr_12a_actions_contacted_officials_factor) <- list("NoContact"="1", "Once"="2", "MoreOnce"="3")

# d_accept %>% dplyr::select(sr_12a_actions_contacted_officials_factor, sr_12a_actions_contacted_officials) %>% head(200)

# Build ordinal logistic regression model
ord_reg_model <- polr(d_accept$sr_12a_actions_contacted_officials_factor ~ 
                        descdynamicnorms_comp + sr_19a_contacting_officials__parents + desccontactnorms_fam_comp + desccontactnorms_nf_comp + sr_20a_rolemodels_parents + descrolemodelnorms_fam_comp + descrolemodelnorms_nf_comp + sr_22a_expect_contact_parents + injunctcontactnorms_fam_comp + injunctcontactnorms_nf_comp + injunctmotivation_fam_comp + injunctmotivation_nf_comp + cimbenefits_comp + cimperceivedrisk_comp + sr_7_believe_about_climate_change + sr_11_harm_future_generations + sr_21a_effective_actions_contacting_officials + efficacy_effectiveness_comp + efficacy_fedstatebusiness_competresp_comp + efficacy_ngo_competresp_comp + behatt_admirablegood_comp + behatt_usefulpleasantsensible_comp + behatt_coolexcitingeasy_comp + sr_30_easy_to_call + sr_31_able_to_call + sr_41a_right_to_modify + sr_41b_laws_of_nature + sr_41c_ingenuity + sr_41d_impotent + sr_41e_govt_do_more + sr_41f_equity + age + gender_male + gender_other + gender_prefernottosay + sr_56_marital_status_marriedpartner + sr_56_marital_status_divorcedseparated + sr_56_marital_status_widowed + sr_57i_dependents + sr_57j_adultchildren + sr_61_education_highschooldegree + sr_61_education_somecollege + sr_61_education_associatedegree + sr_61_education_bachelordegree + sr_61_education_gradorprofdegree + sr_71_employment_status_workparttime + sr_71_employment_status_homemaker + sr_71_employment_status_retired + sr_71_employment_status_student + sr_71_employment_status_unemployed + sr_72_income_25to49k + sr_72_income_50to74k + sr_72_income_75to99k + sr_72_income_100to149k + sr_72_income_150to199k + sr_72_income_200to249k + sr_72_income_over250k + sr_72_income_prefernottoanswer + race_white_dumvar + sr_78_political_affiliation_Rep + sr_78_political_affiliation_Ind + sr_78_political_affiliation_Green + sr_78_political_affiliation_Libertarian + sr_78_political_affiliation_NoParty + sr_79_political_leaning_SomeLib + sr_79_political_leaning_Moderate + sr_79_political_leaning_SomeConservative + sr_79_political_leaning_VeryConservative , data = d_accept, Hess = T)

summary(ord_reg_model)

# Analyze p-values, combine back into summary table
#ctable <- coef(summary(ord_reg_model))
#p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
#ctable <- cbind(ctable, "p value" = p)
#ctable

# Add CIs for variables
#(ci <- confint(ord_reg_model)) # default method gives profiled CIs
#confint.default(ord_reg_model) # CIs assuming normality
#exp(coef(ord_reg_model))
#exp(cbind(OR = coef(ord_reg_model), ci))


```
